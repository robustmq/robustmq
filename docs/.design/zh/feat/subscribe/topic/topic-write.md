# 业务规则
1. 保留消息和延迟发布可以与主题重写结合使用
2. 发布/订阅授权检查在主题重写之前执行
3. 主题重写对PUBLISH,SUBSCRIBE/UNSUBSCRIBE的PACKET有效
4. 主题重写只用于**共享订阅**功能
5. 主题重写只对实际主题有效
6. 主题重写只重写`$share/<group-name>/`后的内容
7. 主题重写只重写`$queue`后的内容
8. 主题重写格式如下
```json
rewrite = [
  {
    action:       "all"
    source_topic: "x/#"
    dest_topic:   "x/y/z/$1"
    re:           "^x/y/(.+)$"
  }
]
```
9. 主题重写规则中的action字段可以是publish(PUBLISH)、subscribe(SUBSCRIBE/UNSUBSCRIBE)或all(PUBLISH/SUBSCRIBE/UNSUBSCRIBE)。
10. 主题重写规则中的source_topic字段是主题过滤器，用于匹配原始主题。
11. 主题重写规则中的dest_topic字段是目标表达式，用于生成新的主题。
12. 主题重写规则中的re字段是正则表达式，用于提取原始主题中的信息。
13. 目标表达式中可以使用$N格式的变量来匹配从正则表达式中提取的元素,$N 的值是指从正则表达式中提取的第 N 个元素。
14. 目标表达式中可以使用${clientid}代表客户端ID，使用${username}代表客户端用户名。
15. 按照配置文件中规则配置的顺序来执行主题重写。
16. 当一个主题可以同时匹配多个主题重写规则的主题过滤器时，仅使用第一个匹配的规则来重写该主题。
17. 如果规则中的正则表达式与MQTT数据包的主题不匹配，则重写失败，其他规则将不会被用来重写(也就是说第一个匹配规则失败，不会使用下面的规则)。
18. 主题重写规则没有限制，可以对主题添加多个数量的重写规则
