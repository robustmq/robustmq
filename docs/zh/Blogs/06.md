# 05: RobustMQ 整体架构概述

> RobustMQ 是基于 Rust 构建的新一代高性能多协议消息队列。愿景是成为新一代云原生与 AI 原生消息基础设施。它不是简单的"又一个消息队列"，而是面向AI时代和云原生需求，对消息队列进行的一次重新思考和设计。

在[《RobustMQ: 技术设计理念综述》](02.md)中讲述了RobustMQ 的核心技术思想。它有六个特点：高性能、Serverless、插件式存储、极简高内聚架构、 计算/存储/调度分离、多协议。本文我们将会详细讲解 RobustMQ 整体架构的设计实现。

在[《介绍 RobustMQ 的 Roles》](./03.md) 中我们知道了节点Role的概念。接下来我们将会详细介绍一下RobustMQ的整体架构。

### 架构概述
RobustMQ 整体由 Meta Service、Broker Server、Storage Adapter、Journal Server、数据存储层五部分组成。
  1. Meta Service：元数据和调度层，负责集群的元数据存储和调度。主要完成:
     - Broker 和 Journal 集群相关的元数据(Topic、Group、Queue、Partition 等)存储、分发。
     - Broker 和 Journal 集群的控制、调度，比如集群节点的上下线、配置存储/分发等。
  2. Broker Server：消息队列逻辑处理层，负责不同消息队列协议的解析和逻辑处理。主要完成：
     - 解析MQTT、Kafka、AMQP、RocketMQ 等协议的解析
     - 整合、抽象不同协议通用的逻辑, 处理不同协议的不同消息队列逻辑。以兼容适配不同的消息队列。
  3. Storage Adapter：存储适配层，存储适配层会将多种 MQ 协议中的 Topic/Queue/Partition 统一抽象为 Shard。同时适配不同的底层存储引擎（比如本地文件存储：Journal Server、远程的HDFS、对象存储、自研的存储组件等等），从而实现存储适配层的插件化、可插拔。也就是说，Storage Adapter会根据配置，将数据存储到不同的存储引擎。
  4. Journal Server：是 RobustMQ 自带的持久化存储引擎。它是一个类似Apache Bookeeper 的本地多副本、分段式、持久化存储服务。它目标是构建一个高性能、高吞吐、高可靠的持久化存储引擎。从Storage Adapter的视角看，Journal Server 只是它对接的存储引擎之一。你可以理解它是为了解决RobustMQM 高内聚 、无外部依赖的特性而特意实现的。
  5. 数据存储层（本地 Or 远程存储）： 指数据的存储层。数据的存储层可以是（本机的内存），也可以是远程存储服务（比如HDFS、 MinIO、Aws S3等）。它由 Storage Adapter负责对接。


### 详细架构
先来看下图：
![image](../../images/robustmq-architecture.png)

如上图所示，这是一个由三个RobustMQ Node组成的集群，如果不选择使用外部的存储引擎，则不需要依赖任何外部组件。也就是说，可以通过./bin/robust-server start 启动每个节点。

从单节点来看，由Meta Service