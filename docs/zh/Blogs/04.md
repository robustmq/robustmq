# 04: 聊聊 RobustMQ 在产品层面的思考

> RobustMQ 是基于 Rust 构建的新一代高性能多协议消息队列。愿景是成为新一代云原生与 AI 原生消息基础设施。它不是简单的"又一个消息队列"，而是面向AI时代和云原生需求，对消息队列进行的一次重新思考和设计。

从开始写 RobustMQ 的第一天开始，我们就一直在思考自己有没有陷入在技术思维茧房里，是不是在做一件没有实际业务需求的事情，是不是在技术自嗨。

而在开发 RobustMQ 的这两年里，我们也受到了很多质疑。觉得我们“在造一个新的轮子”，“又一个消息队列”，”消息队列太成熟了，没有增量，这个领域一点都不性感“，“我们的设想太宏大了，太难了”。

我们一直知道，如果方向错了，再努力都没用，所以本文我们想从产品思维的角度来聊一聊我们在这段时间的一些思考。

### 产品定位

RobustMQ 是一个标准的消息队列，也只是消息队列。产品定位上它和RocketMQ、Kafka、Pulsar、RabbitMQ 是一样的。在未来的某一天，我们希望社区中谈到消息队列演进的时候可以是：RabbitMQ -> Kafka -> RocketMQ -> Pulsar -> RobustMQ。

因此来说，RobustMQ 的产品定位是很清晰的。就是一个标准的消息队列产品。

我们认为在未来某一天，如果你需要消息队列，你的选项清单里面就必定会有RobustMQ。那为什么你会选它呢？

对我们来说，我们会希望你的理由是：
1. 它很快、很稳定、性能很高。也就是它会有很高的QPS/吞吐，稳定的耗时表现。能满足比如流、消息、金融等等各种场景下对耗时和吞吐的需求。
2. 它可以兼容当前你所用到的消息队列协议（比如，MQTT/AMQP/Kafka/RocketMQ等等），迁移成本低。且它在性能、稳定性、成本、面向场景更丰富等等方面表现比当前产品更好。
3. 它的插件式存储架构，可以完全满足业务中不同场景对耗时、成本的需求。比如同一个集群中对耗时要求高的场景可以使用本地存储，数据量大且需要控制成本的可以使用远程对象存储等等。
4. 它可以让你需要维护多套消息队列了，一套消息队列就可以满足公司内的各种消息中间件场景。
5. 它具备完整的弹性扩缩容能力，完美适配K8s架构，在成本和弹性方面表现更优越。

也就是说，从产品视角来看，RobustMQ 希望作为现有消息队列产品的平替而出现的。我们希望它通过更稳定、性能表现更好，足够弹性，成本更低、能满足更多场景、迁移成本低等优势，来吸引你从当前的消息队列产品迁移到RobustMQ。

并且我们认为RobustMQ 只兼容当前协议，不设计新的通信协议是一个非常正确的选择。因为设计新的通信协议，意味着要重建整个生态，各方面工作量大且难以推广。兼容主流协议，则无需重建SDK等等生态，只需关注极致优化内核，在性能、稳定性、弹性、成本等等方面和当前产品做出差异即可。因此我们会认为如果设计一个新的通信协议，将会是RobustMQ 失败的开始。

### 商业化视角
RobustMQ 从写下第一行代码开始，就坚持开源优先的原则，它的目标始终是成为Apache 顶级项目。但是此刻，我们希望从商业化视角来看看RobustMQ 是否有价值？ 也就是想从商业化视角，看一下RobustMQ 是否有存在的意义。

所以我们问了一个问题：当 RobustMQ 完成所有技术设想后，它的受众是谁，这些受众会认可它的价值吗？今天，我们的答案肯定是有的。先来看看我们认为的它的受众是谁。我们认为有两类：TO B 厂商和独立企业。

- To B 厂商(比如云厂商)

在现有云厂商（特别是国内）的实际运营中，售卖的消息队列产品大都是开源产品的托管，比如托管Kafka、托管RabbitMQ、托管RocketMQ等等。对云厂商来说，托管开源产品的好处很多（比如开发成本低，产品稳定，能快速带来收入等等）。但是从长期运营角度来看，开源托管很难做出（和其他云厂商、用户自建）差异性优势，很容易沦落为卖资源（Cpu/内存）。

因此云产商为了提高利润率和差异性优势，会在开源上进行二次开发，而二次开发则会遇到下面两个问题：
1. 每个开源托管是不是都要二次开发。如果是那么投入成本大，无法形成合力。如果不是，也就失去了差异性，增长空间有限。从而团队就会思考，能不能只有一款消息队列，在这款消息队列上去适配多种协议，这样技术投入可形成合力，也更容易做出差异性。从而在成本、性能上做出差异性优势。
   
2. 二次开发从长期来看会和社区分叉，无法用到社区优势，很难长期坚持，最终还是得回归社区。导致投入了大量人力，还是回到原点，还是无法做出差异性优势。

而 RobustMQ 设计之初就希望满足这个场景，它的弹性设计、插件化存储、多协议、开源这四个特性，刚好可以完美解决上述两个问题。

想象个场景，如果robustMQ 完成了它设想中的多协议、serverless、插件化存储等特性，那么对这些厂商来说，它拿到 RobustMQ 后，就可以在它的基础上，适配自己云上的合适的存储引擎，就可以满足不同场景、方向的消息队列需求。此时对云厂商的价值来说，只需要一套内核。在长期人力、运维投入的成本都会成倍下降，且更容易通过优化内核做出自身的差异性优势。而这个场景，在我们看来不是臆想，是有实际价值的。

- 独立企业

如果是小型企业，在业务场景不复杂的情况下，使用哪种消息队列产品都差不多。而当企业的规模变大，业务场景变复杂后。一般需要多种消息队列。此时不管是业务方选型使用、基础架构团队维护多种消息队列的成本都是非常高的。因此很多企业为了提升业务稳定性、降低运维成本、降低人才储备成本，都会限制只选用一款或两款消息队列。

此时，如果有一款能够适配多协议，性能和稳定性、弹性、能面向多种场景的消息队列的话。是完美符合这类型企业的诉求的。这协议 RobustMQ 在设计之初希望满足的场景。因此我们认为RobustMQ 对企业也是有价值的。

因此，当有一天 RobustMQ 趋于成熟后，我们认为下面两种场景会是我们的重要落地方向，也是我们吸引用户的方向：
1. 云厂商/大型企业的一个MQ需求：需要一款All In One 的消息队列来当作消息底座来满足各种不同场景，从而提升稳定性，降低投入成本。
2. MQTT/Kafka/RabbitMQ等产品平替需求：在性能、弹性、成本等方面对当前产品不满意的，有平替需求的。比如对 Kafka 的弹性/成本有需求的，对当前MQTT Broker 实现有更高性能需求的，对RabbitMQ 网络分区/性能有顾虑的。就可以使用RobustMQ 来替代当前的实现。

### 如何从0到1
我们经常会在想，这确实是一个很枯燥，设想很宏大的事情。我们经常在想，能坚持下来吗？如何完成了冷启动？如何推动 RobustMQ 从0到1呢？

从产品思维的角度，我们会认为有几个阶段：
1. 在第一个阶段，RobustMQ 的用户是RobustMQ的开发者。我们这些开发者通过个人技术追求、开源热情从这个项目找到成就感，抱着学习rust、学习分布式存储、增加开源影响力等等去完成 RobustMQ 的整体架构搭建等等第一阶段工作。
2. 在第二个阶段，RobustMQ 的用户我们希望是需要 MQTT 协议的用户。为什么是MQTT协议呢？有三个原因：
   1. MQTT 协议本身轻量简单，功能不复杂，重新实现一个MQTT Broker且做出差异性优势是最快的。也就是体现RobustMQ 实际落地价值最快的。
   2. 业界目前并没有表现特别优秀的MQTT Broker
   3. 前段时间EMQX 转为商业化License，社区应该会需要一款优秀的替代。
3. 在第三阶段，RobustMQ 的用户是我们前面设想的所有用户。我们继续逐步适配完善多种协议，比如支持Kafka、AMQP 等等协议，不断扩展 RobustMQ 的使用场景，从而完成我们的设想。

在当前阶段，我们认为我们已经走到了第二步，且第二步的第一阶段开发基本完成。正在往第三阶段前进。因此从产品思维的角度来看，我们把RobustMQ 做成了一件可坚持、可持续的事情。

### 为什么坚持开源
曾经有人问过我们，这是要搞商业化产品吗？ 我们的回答永远是：No。我们的目标一直是成为Apache 的顶级项目。为什么呢？

在我们看来，RobustMQ 是一件非常宏大的设想、工作量非常大。如果我们在一开始把它当作一款商业化产品打造，那么它永远是做不好的。因为商业化的思维会让我们所有的技术思考变形。基础软件是需要不断琢磨、沉淀、修正、优化的。而在商业化的压力下，这些沉淀会变形，会变得急功近利。

也就是说，我们希望 RobustMQ 是一件有价值的事，而只有100%开源才能赋予它价值，让它成功。

### 总结
所以从产品角度来看，RobustMQ 是一个标准的消息队列。核心价值是通过技术优化，在各种方面比当前产品表现更好，是现有消息队列更优的平替。

也就是它不是“又一个消息队列而已”。我们希望它是“一个更好的消息队列”。

> 基础软件是一段漫长的旅途，我们始终认为，拥抱开源、拥抱热爱、拥抱坚持才能做好。我们始终在摸索、调整的路上。希望在未来的某一天，我们会有一个答案：RobustMQ 真是一件有价值的事。
